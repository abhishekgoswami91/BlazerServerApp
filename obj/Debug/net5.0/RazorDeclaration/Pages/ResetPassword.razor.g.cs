// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace BlazorServerApp.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using BlazorServerApp;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using BlazorServerApp.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Blazored;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Blazored.Modal;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "F:\VS2019 Projects\BlazorServerApp\_Imports.razor"
using Blazored.Modal.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "F:\VS2019 Projects\BlazorServerApp\Pages\ResetPassword.razor"
using Microsoft.AspNetCore.WebUtilities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "F:\VS2019 Projects\BlazorServerApp\Pages\ResetPassword.razor"
using System.Text.Encodings.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "F:\VS2019 Projects\BlazorServerApp\Pages\ResetPassword.razor"
using System.Text;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "F:\VS2019 Projects\BlazorServerApp\Pages\ResetPassword.razor"
using System.ComponentModel.DataAnnotations;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/ResetPassword")]
    public partial class ResetPassword : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 85 "F:\VS2019 Projects\BlazorServerApp\Pages\ResetPassword.razor"
       

    InputModel requestPasswordModel = new InputModel();
    ResetPasswordModel validatePasswordModel = new ResetPasswordModel();

    string email = "";
    string token = "";

    bool IsResetSend = false;
    bool IsResetToken = false;

    protected override void OnInitialized()
    {

        //GetHttpParameters();

    }

    //public void GetHttpParameters()
    //{
    //    var uriBuilder = new UriBuilder(navigationManager.Uri);
    //    var httpQuery = System.Web.HttpUtility.ParseQueryString(uriBuilder.Query);

    //    email = httpQuery["email"] ?? "";
    //    token = httpQuery["token"] ?? "";

    //    if (!string.IsNullOrEmpty(email) && !string.IsNullOrEmpty(token))
    //    {
    //        IsResetToken = true;

    //    }
    //}

    //public async void SendResetPassword()
    //{
    //    List<string> mailTo = new List<string>();

    //    string passwordResetToken;
    //    string passwordResetUrl;

    //    var user = await userManager.FindByEmailAsync(requestPasswordModel.Email);

    //    if (user != null)
    //    {
    //        passwordResetUrl = navigationManager.BaseUri;

    //        passwordResetToken = await userManager.GeneratePasswordResetTokenAsync(user);

    //        passwordResetToken = WebEncoders.Base64UrlEncode(Encoding.UTF8.GetBytes(passwordResetToken));

    //        passwordResetUrl = "https://localhost:44384/ResetPassword?email=" + user.Email + "&token=" + passwordResetToken;

    //        mailTo.Add(requestPasswordModel.Email);

    //        //Send mail with the relevant token
    //        //Webco.Email.Entities.EmailObject emailObject = new Webco.Email.Entities.EmailObject();
    //        //emailObject.Email_To = mailTo;
    //        //emailObject.Email_Subject = "Password Reset Webco !";
    //        //emailObject.Email_Message = $"Hy There, <br> Please click this link to reset your password : <br><a href='{HtmlEncoder.Default.Encode(passwordResetUrl)}'> clikcing here </a>.";
    //        //emailObject.SendEmail(emailObject);

    //        IsResetSend = true;
    //    }
    //    else
    //    {
    //        //it's a lie
    //        IsResetSend = true;
    //    }
    //}

    public async void SetResetPassword()
    {
        //List<string> mailTo = new List<string>();

        //var user = await userManager.FindByEmailAsync(email);

        //if (user != null)
        //{
        //    token = System.Text.Encoding.UTF8.GetString(WebEncoders.Base64UrlDecode(token));

        //    var result = await userManager.ResetPasswordAsync(user, token, validatePasswordModel.ConfirmPassword);

        //    if (result.Succeeded)
        //    {

        //        mailTo.Add(email);

        //        //Send mail with the relevant token
        //        //Webco.Email.Entities.EmailObject emailObject = new Webco.Email.Entities.EmailObject();
        //        //emailObject.Email_To = mailTo;
        //        //emailObject.Email_Subject = "Password Reset Webco !";
        //        //emailObject.Email_Message = $"Hy There, <br> You password was just reset at webco. Not you ? <br> Contact webco for support.";
        //        //emailObject.SendEmail(emailObject);

        //        navigationManager.NavigateTo("/LoginUserResetPasswordComplete", true);
        //    }
        //    else
        //    {
        //        navigationManager.NavigateTo("/LoginUserResetPasswordError", true);
        //    }
        //}
        //else
        //{
        //    navigationManager.NavigateTo("/LoginUserResetPasswordError", true);
        //}

    }

    public class InputModel
    {
        [Required]
        [EmailAddress]
        public string Email { get; set; }
    }

    public class ResetPasswordModel
    {
        [Required]
        public string Password { get; set; }
        [Required]
        [Compare(nameof(Password))]
        public string ConfirmPassword { get; set; }
    }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager navigationManager { get; set; }
    }
}
#pragma warning restore 1591
